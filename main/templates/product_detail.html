{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
    <h2>{{ product.title }}</h2>
    <p>{{ product.description }}</p>

    <h4>Videos:</h4>
    <ul>
        {% for video in product.videos.all %}
            <li>
                <strong>{{ video.title }}</strong><br>
                <iframe id="video-{{ video.id }}" width="560" height="315"
                        src="https://www.youtube.com/embed/{{ video.youtube_id }}"
                        frameborder="0" allowfullscreen></iframe>
                
                <div id="quiz-btn-{{ video.id }}" class="mt-2" style="display: none;">
                    <a href="{% url 'quiz' video.id %}" class="btn btn-success">Take Quiz</a>
                </div>
            </li>
        {% empty %}
            <p>No videos uploaded for this product.</p>
        {% endfor %}
    </ul>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        {% for video in product.videos.all %}
            (function(videoId) {
                setTimeout(function() {
                    var btn = document.getElementById("quiz-btn-" + videoId);
                    if (btn) btn.style.display = "block";
                }, 10000);
            })({{ video.id }});
        {% endfor %}
    });
</script>
{% endblock %}
